import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Sample dataset (in practice, you would load this from a file)
data = {
    'EmployeeID': [1, 2, 3, 4, 5],
    'Name': ['John', 'Emma', 'Michael', 'Sophia', 'William'],
    'Department': ['HR', 'IT', 'Finance', 'HR', 'Marketing'],
    'Region': ['North', 'South', 'East', 'West', 'North'],
    'PerformanceScore': [85, 90, 78, 92, 88]
}

# Create DataFrame
df = pd.DataFrame(data)

# For the full dataset of 100 employees, you would use:
# df = pd.read_csv('employee_data.csv')

# Calculate frequency count for HR department
hr_count = df['Department'].value_counts().get('HR', 0)

# Print HR frequency count
print(f"Frequency count for HR department: {hr_count}")

# Create histogram of department distribution
plt.figure(figsize=(10, 6))
sns.countplot(data=df, x='Department', order=df['Department'].value_counts().index)
plt.title('Distribution of Employees Across Departments', fontsize=16)
plt.xlabel('Department', fontsize=14)
plt.ylabel('Number of Employees', fontsize=14)
plt.xticks(rotation=45)
plt.tight_layout()

# Save the visualization as HTML
import plotly.express as px

fig = px.histogram(df, x='Department', title='Distribution of Employees Across Departments')
html_content = f"""
<html>
<head>
    <title>Employee Department Distribution</title>
</head>
<body>
    <h1>Employee Department Distribution</h1>
    <p>Frequency count for HR department: {hr_count}</p>
    <div>{fig.to_html(full_html=False)}</div>
    <p>Generated by: 24f1000537@ds.study.iitm.ac.in</p>
</body>
</html>
"""

with open('employee_visualization.html', 'w') as f:
    f.write(html_content)

print("HTML file saved as 'employee_visualization.html'")
